"use strict";(self.webpackChunkctrader_openapi_docs=self.webpackChunkctrader_openapi_docs||[]).push([[824],{2636:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"contacting-api/acquiring-credentials","title":"Acquiring Credentials","description":"Once we are connected to the server, we can send a message to it, and the server","source":"@site/docs/02-contacting-api/04-acquiring-credentials.mdx","sourceDirName":"02-contacting-api","slug":"/contacting-api/acquiring-credentials","permalink":"/ctoa/contacting-api/acquiring-credentials","draft":false,"unlisted":false,"editUrl":"https://github.com/m-ahmadi/ctoa/blob/main/docs/02-contacting-api/04-acquiring-credentials.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"sidebar","previous":{"title":"Exchanging Messages","permalink":"/ctoa/contacting-api/exchanging-messages"},"next":{"title":"Authentication","permalink":"/ctoa/contacting-api/authentication"}}');var s=t(4848),c=t(8453),i=t(5537),o=t(9329);const a={},l="Acquiring Credentials",d={},h=[{value:"How to Get ClientID, ClientSecret, AccessToken and RefreshToken",id:"how-to-get-clientid-clientsecret-accesstoken-and-refreshtoken",level:2},{value:"Part 1: Getting <strong><code>ClientID</code></strong> and <strong><code>ClientSecret</code></strong>",id:"part-1-getting-clientid-and-clientsecret",level:3},{value:"Part 2: Getting <strong><code>Authorization Code</code></strong>, <strong><code>AccessToken</code></strong> and <strong><code>RefreshToken</code></strong>",id:"part-2-getting-authorization-code-accesstoken-and-refreshtoken",level:3},{value:"Summary of the Whole Process",id:"summary-of-the-whole-process",level:3},{value:"How to Get AccountID",id:"how-to-get-accountid",level:2}];function u(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"acquiring-credentials",children:"Acquiring Credentials"})}),"\n",(0,s.jsxs)(n.p,{children:["Once we are connected to the server, we can send a message to it, and the server\nwill respond to our message too, but the problem is because server does not know\nwho we are, it will respond to any message we send by sending an error message\nback (",(0,s.jsx)(n.code,{children:"payloadType"})," of ",(0,s.jsx)(n.code,{children:"2142"}),"). In order to introduce ourself properly to the\nserver, we need to have the proper credentials, so let's see how we can them."]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-get-clientid-clientsecret-accesstoken-and-refreshtoken",children:"How to Get ClientID, ClientSecret, AccessToken and RefreshToken"}),"\n",(0,s.jsxs)(n.h3,{id:"part-1-getting-clientid-and-clientsecret",children:["Part 1: Getting ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ClientID"})})," and ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ClientSecret"})})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to this page: ",(0,s.jsx)(n.a,{href:"https://openapi.ctrader.com/apps",children:"https://openapi.ctrader.com/apps"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Log-in with your cTrader account (if not already logged-in)."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"= Add new App"})})," button."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Fill-in the mandatory fields: ",(0,s.jsx)(n.code,{children:"Application name"})," and ",(0,s.jsx)(n.code,{children:"Description"}),", etc."]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"+ Add redirect URL"})})," and put ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"https://example.com"})}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Save"})})," and now your entry is created."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Credentials"})})," on created entry and there you have the ",(0,s.jsx)(n.code,{children:"Client ID"}),"\nand ",(0,s.jsx)(n.code,{children:"Secret"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Wait untill ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Status"})})," of created entry changes from ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Submitted"})})," to\n",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Active"})}),".",(0,s.jsx)(n.br,{}),"\n","(might take up to 3 bussinus days)"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"So far we have the following pieces:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"REDIRECT_URI=...\nCLIENT_ID=...\nCLIENT_SECRET=...\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"part-2-getting-authorization-code-accesstoken-and-refreshtoken",children:["Part 2: Getting ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Authorization Code"})}),", ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"AccessToken"})})," and ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"RefreshToken"})})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Must open below URL in browser:",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://id.ctrader.com/my/settings/openapi/grantingaccess/",children:"https://id.ctrader.com/my/settings/openapi/grantingaccess/"}),(0,s.jsx)(n.br,{}),"\n","with below query parameters:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Query Param"}),(0,s.jsx)(n.th,{children:"Where Value Comes From"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"redirect_uri="})}),(0,s.jsx)(n.td,{children:"from Part 1, step 3.2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client_id="})}),(0,s.jsx)(n.td,{children:"from Part 1, step 3.4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client_secret="})}),(0,s.jsx)(n.td,{children:"from Part 1, step 3.4"})]})]})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In opened page click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Allow access"})})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After clicking ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Allow access"})}),", you will be redirected to a url that has a\nquery parameter named ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"code"})}),", save its value:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CODE=...\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Must open below URL: (in under 60 seconds of Part 2, step 1)\n",(0,s.jsx)(n.a,{href:"https://openapi.ctrader.com/apps/token?grant_type=authorization_code",children:"https://openapi.ctrader.com/apps/token?grant_type=authorization_code"}),(0,s.jsx)(n.br,{}),"\n","with below query parameters:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Query Param"}),(0,s.jsx)(n.th,{children:"Its Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"REDIRECT_URI ="}),(0,s.jsx)(n.td,{children:"same as before"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CLIENT_ID="}),(0,s.jsx)(n.td,{children:"same as before"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CLIENT_SECRET="}),(0,s.jsx)(n.td,{children:"same as before"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CODE="}),(0,s.jsx)(n.td,{children:"from previous step (Part 2, step 3)"})]})]})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Now you have the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"AccessToken"})})," and ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"RefreshToken"})})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"summary-of-the-whole-process",children:"Summary of the Whole Process"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Second link must be opened in under 60 seconds from when first link was opened."})}),"\n",(0,s.jsxs)(i.A,{children:[(0,s.jsx)(o.A,{value:"Windows",label:"Windows",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-batch",children:'@echo off\n\nset /p CLIENT_ID="ClientID: "\nset /p CLIENT_SECRET= "ClientSecret: "\nset /p REDIRECT_URI="Redicrect URI: "\nset SCOPE=trading\nstart chrome "https://id.ctrader.com/my/settings/openapi/grantingaccess/?client_id=%CLIENT_ID%&redirect_uri=%REDIRECT_URI%&scope=%SCOPE%&product=web"\n\nset /p CODE="Authorization Code: "\nstart chrome "https://openapi.ctrader.com/apps/token?grant_type=authorization_code&code=%CODE%&redirect_uri=%REDIRECT_URI%&client_id=%CLIENT_ID%&client_secret=%CLIENT_SECRET%"\n'})})}),(0,s.jsx)(o.A,{value:"Linux",label:"Linux",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'read -p "ClientID: " CLIENT_ID\nread -p "ClientSecret: " CLIENT_SECRET\nread -p "Redicrect URI: " REDIRECT_URI\nSCOPE = \'trading\'\nfirefox "https://id.ctrader.com/my/settings/openapi/grantingaccess/?client_id=$CLIENT_ID&redirect_uri=$REDIRECT_URI&scope=$SCOPE&product=web"\n\nread -p "Authorization Code: " CODE\nURL = "https://openapi.ctrader.com/apps/token?grant_type=authorization_code&code=$CODE&redirect_uri=$REDIRECT_URI&client_id=$CLIENT_ID&client_secret=$CLIENT_SECRET"\ncurl -X GET $URL -H "Accept: application/json" -H "Content-Type: application/json"\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-get-accountid",children:"How to Get AccountID"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Go to this page ",(0,s.jsx)(n.a,{href:"https://openapi.ctrader.com/apps",children:"https://openapi.ctrader.com/apps"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Log-in with your cTrader account (if not already logged-in)."}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Sandbox"})})," on one of the entries.","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Under ",(0,s.jsx)(n.strong,{children:'"Scope"'}),", select ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Account info"})}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Get token"})}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Allow access"})}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Copy the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Access token"})}),' (this is called "sandbox access token").']}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Open below URL with an ",(0,s.jsx)(n.code,{children:"accessToken"})," query param set to the token acquired in\nprevious step:",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://api.spotware.com/connect/tradingaccounts?access_token=",children:"https://api.spotware.com/connect/tradingaccounts?access_token="}),(0,s.jsx)(n.br,{}),"\n","(",(0,s.jsx)(n.strong,{children:"Note"}),": You can also use your\n",(0,s.jsx)(n.a,{href:"./acquiring-credentials",children:'"real access token"'})," here too)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Now you will have a list of all of your trading accounts associated with your\ncTrader accounts in ",(0,s.jsx)(n.code,{children:"JSON"})," format."]}),"\n",(0,s.jsx)(n.p,{children:"You will have below properties for each trading account:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// prettier-ignore\n{\n  "accountId":                   0,\n  "accountNumber":               0,\n  "live":                        false,\n  "brokerName":                  "",\n  "brokerTitle":                 "",\n  "depositCurrency":             "",\n  "traderRegistrationTimestamp": 0,\n  "traderAccountType":           "",\n  "leverage":                    0,\n  "leverageInCents":             0,\n  "balance":                     0,\n  "deleted":                     false,\n  "accountStatus":               "",\n  "swapFree":                    false,\n  "moneyDigits":                 0\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},5537:(e,n,t)=>{t.d(n,{A:()=>w});var r=t(6540),s=t(4164),c=t(5627),i=t(6347),o=t(372),a=t(604),l=t(1861),d=t(8749);function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,l.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const t=(0,i.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,c=u(e),[i,a]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:c})),[l,h]=x({queryString:t,groupId:s}),[j,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,d.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),m=(()=>{const e=l??j;return p({value:e,tabValues:c})?e:null})();(0,o.A)(()=>{m&&a(m)},[m]);return{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!p({value:e,tabValues:c}))throw new Error(`Can't select invalid tab value=${e}`);a(e),h(e),g(e)},[h,g,c]),tabValues:c}}var g=t(9136);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(4848);function b({className:e,block:n,selectedValue:t,selectValue:r,tabValues:i}){const o=[],{blockElementScrollPositionUntilNextRender:a}=(0,c.a_)(),l=e=>{const n=e.currentTarget,s=o.indexOf(n),c=i[s].value;c!==t&&(a(n),r(c))},d=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:r})=>(0,f.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:l,...r,className:(0,s.A)("tabs__item",m.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function C({lazy:e,children:n,selectedValue:t}){const c=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=c.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:c.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function v(e){const n=j(e);return(0,f.jsxs)("div",{className:(0,s.A)("tabs-container",m.tabList),children:[(0,f.jsx)(b,{...n,...e}),(0,f.jsx)(C,{...n,...e})]})}function w(e){const n=(0,g.A)();return(0,f.jsx)(v,{...e,children:h(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(6540);const s={},c=r.createContext(s);function i(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(c.Provider,{value:n},e.children)}},9329:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var r=t(4164);const s={tabItem:"tabItem_Ymn6"};var c=t(4848);function i({children:e,hidden:n,className:t}){return(0,c.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,t),hidden:n,children:e})}}}]);